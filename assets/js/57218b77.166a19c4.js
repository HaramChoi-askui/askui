"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7376],{5318:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var a=n(7378);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=u(n),d=r,g=m["".concat(s,".").concat(d)]||m[d]||p[d]||i;return n?a.createElement(g,o(o({ref:t},c),{},{components:n})):a.createElement(g,o({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var u=2;u<i;u++)o[u]=n[u];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9874:function(e,t,n){n.r(t),n.d(t,{assets:function(){return m},contentTitle:function(){return c},default:function(){return k},frontMatter:function(){return u},metadata:function(){return p},toc:function(){return d}});var a=n(5773),r=n(808),i=n(7378),o=n(5318);function l(e){e.children;var t=e.link;return i.createElement("span",null,i.createElement("button",{onClick:function(){return navigator.clipboard.writeText(t)}},"Copy tag"))}var s=["components"],u={custom_edit_url:null},c="Local Docker",p={unversionedId:"general/Continuous Integration/local-docker",id:"general/Continuous Integration/local-docker",title:"Local Docker",description:"We maintain Docker Images for running askui tests locally and in CI pipelines. The images contain the askui server and a browser. Currently, we offer some of the latest versions of Chrome and Firefox. The askui library can connect to the server inside the Docker container to execute the test steps inside it.",source:"@site/docs/general/04-Continuous Integration/local-docker.md",sourceDirName:"general/04-Continuous Integration",slug:"/general/Continuous Integration/local-docker",permalink:"/docs/general/Continuous Integration/local-docker",editUrl:null,tags:[],version:"current",frontMatter:{custom_edit_url:null},sidebar:"docsSidebar",previous:{title:"Gitlab CI/CD",permalink:"/docs/general/Continuous Integration/gitlab-ci"},next:{title:"Annotate Image",permalink:"/docs/general/Tooling/annotate-image"}},m={},d=[{value:"Authentication &amp; Authorization",id:"authentication--authorization",level:2},{value:"Available Images",id:"available-images",level:2},{value:"Configure a Container",id:"configure-a-container",level:2},{value:"Start a Container from Inside a Jasmine Test Suite",id:"start-a-container-from-inside-a-jasmine-test-suite",level:2},{value:"Connect via VNC",id:"connect-via-vnc",level:2}],g={toc:d};function k(e){var t=e.components,i=(0,r.Z)(e,s);return(0,o.kt)("wrapper",(0,a.Z)({},g,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"local-docker"},"Local Docker"),(0,o.kt)("p",null,"We maintain Docker Images for running askui tests locally and in CI pipelines. The images contain the askui server and a browser. Currently, we offer some of the latest versions of Chrome and Firefox. The askui library can connect to the server inside the Docker container to execute the test steps inside it."),(0,o.kt)("h2",{id:"authentication--authorization"},"Authentication & Authorization"),(0,o.kt)("p",null,"Currently, the images are hosted on a private registry. You need to authenticate and authorize yourself in order a to access them. The username and token are going to be provided by your contact person at askui. The token is the one you also use for downloading the library."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"docker login registry.gitlab.com -u <username> -p <token>\n")),(0,o.kt)("h2",{id:"available-images"},"Available Images"),(0,o.kt)("p",null,"The images can be downloaded from"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"registry.gitlab.com/vqa4gui/mvp/askui/browser/<browser>:v0.9.1-<browser_version>-<platform>")),(0,o.kt)("p",null,"whereby ",(0,o.kt)("inlineCode",{parentName:"p"},"<browser>"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"<browser_version>")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"<platform>")," need to be replaced with concrete values."),(0,o.kt)("p",null,"The following list shows the images we currently provide:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Browser"),(0,o.kt)("th",{parentName:"tr",align:null},"Browser Version"),(0,o.kt)("th",{parentName:"tr",align:null},"Release Version"),(0,o.kt)("th",{parentName:"tr",align:null},"Platform"),(0,o.kt)("th",{parentName:"tr",align:null}))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"chrome"),(0,o.kt)("td",{parentName:"tr",align:null},"100.0.4896.60"),(0,o.kt)("td",{parentName:"tr",align:null},"v0.9.1"),(0,o.kt)("td",{parentName:"tr",align:null},"amd64"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)(l,{link:"registry.gitlab.com/vqa4gui/mvp/askui/browser/chrome:v0.9.1-100.0.4896.60-amd64",mdxType:"ClipboardButton"}))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"chrome"),(0,o.kt)("td",{parentName:"tr",align:null},"99.0.4844.51"),(0,o.kt)("td",{parentName:"tr",align:null},"v0.9.1"),(0,o.kt)("td",{parentName:"tr",align:null},"amd64"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)(l,{link:"registry.gitlab.com/vqa4gui/mvp/askui/browser/chrome:v0.9.1-99.0.4844.51-amd64",mdxType:"ClipboardButton"}))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"chrome"),(0,o.kt)("td",{parentName:"tr",align:null},"97.0.4692.71"),(0,o.kt)("td",{parentName:"tr",align:null},"v0.9.1"),(0,o.kt)("td",{parentName:"tr",align:null},"amd64"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)(l,{link:"registry.gitlab.com/vqa4gui/mvp/askui/browser/chrome:v0.9.1-97.0.4692.71-amd64",mdxType:"ClipboardButton"}))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"chrome"),(0,o.kt)("td",{parentName:"tr",align:null},"90.0.4430.212"),(0,o.kt)("td",{parentName:"tr",align:null},"v0.9.1"),(0,o.kt)("td",{parentName:"tr",align:null},"amd64"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)(l,{link:"registry.gitlab.com/vqa4gui/mvp/askui/browser/chrome:v0.9.1-90.0.4430.212-amd64",mdxType:"ClipboardButton"}))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"firefox"),(0,o.kt)("td",{parentName:"tr",align:null},"98.0.2"),(0,o.kt)("td",{parentName:"tr",align:null},"v0.9.1"),(0,o.kt)("td",{parentName:"tr",align:null},"amd64"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)(l,{link:"registry.gitlab.com/vqa4gui/mvp/askui/browser/firefox:v0.9.1-98.0.2-amd64",mdxType:"ClipboardButton"}))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"firefox"),(0,o.kt)("td",{parentName:"tr",align:null},"97.0.2"),(0,o.kt)("td",{parentName:"tr",align:null},"v0.9.1"),(0,o.kt)("td",{parentName:"tr",align:null},"amd64"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)(l,{link:"registry.gitlab.com/vqa4gui/mvp/askui/browser/firefox:v0.9.1-97.0.2-amd64",mdxType:"ClipboardButton"}))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"firefox"),(0,o.kt)("td",{parentName:"tr",align:null},"96.0.3"),(0,o.kt)("td",{parentName:"tr",align:null},"v0.9.1"),(0,o.kt)("td",{parentName:"tr",align:null},"amd64"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)(l,{link:"registry.gitlab.com/vqa4gui/mvp/askui/browser/firefox:v0.9.1-96.0.3-amd64",mdxType:"ClipboardButton"}))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"firefox"),(0,o.kt)("td",{parentName:"tr",align:null},"82.0.3"),(0,o.kt)("td",{parentName:"tr",align:null},"v0.9.1"),(0,o.kt)("td",{parentName:"tr",align:null},"amd64"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)(l,{link:"registry.gitlab.com/vqa4gui/mvp/askui/browser/firefox:v0.9.1-82.0.3-amd64",mdxType:"ClipboardButton"}))))),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Currently, we do not offer images for ",(0,o.kt)("strong",{parentName:"p"},"ARM"),"."))),(0,o.kt)("p",null,"Pull the image using"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"docker pull registry.gitlab.com/vqa4gui/mvp/askui/browser/<browser>:<releaseVersion>-<browserVersion>-amd64\n")),(0,o.kt)("p",null,"or use something like ",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/testcontainers"},"Testcontainers")," (see ",(0,o.kt)("a",{parentName:"p",href:"#start-container-in-jasmin-test-suite"},"Start Container in Jasmine Test Suite")," as an example) to pull the image from inside your test suite."),(0,o.kt)("h2",{id:"configure-a-container"},"Configure a Container"),(0,o.kt)("p",null,"When starting a container, the following environment variables can be used to configure it:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Variable"),(0,o.kt)("th",{parentName:"tr",align:null},"Default Value"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"ENABLE_VNC"),(0,o.kt)("td",{parentName:"tr",align:null},"false"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"true")," if VNC is enabled so that you can connect and observe whats happening inside the container.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"SCREEN_RESOLUTION"),(0,o.kt)("td",{parentName:"tr",align:null},"1920x1080"),(0,o.kt)("td",{parentName:"tr",align:null},"The screen resolution used inside the container in the format ",(0,o.kt)("inlineCode",{parentName:"td"},"<width>x<height>"),".")))),(0,o.kt)("h2",{id:"start-a-container-from-inside-a-jasmine-test-suite"},"Start a Container from Inside a Jasmine Test Suite"),(0,o.kt)("p",null,"The following example shows how to use the containers inside a Jasmine test suite without needing to pull and start the container beforehand."),(0,o.kt)("p",null,"First, install ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/testcontainers/testcontainers-node"},"Testcontainers"),", a Node.js library that supports tests, providing lightweight, throwaway instances of common databases, Selenium web browsers, or anything else that can run in a Docker container."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"npm i -D testcontainers\n")),(0,o.kt)("p",null,"Then, to run your tests inside a container, include a ",(0,o.kt)("inlineCode",{parentName:"p"},"beforeAll")," setup function like in the following example. It is going to pull and start the container with the askui server and browser mapping the ports exposed by the container to free ports on your machine (randomly chose out of the free ports available at runtime to prevent collision) which you and the askui library can use to connect to the container."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { AskuiClient } from '@vqa4gui/askui';\nimport { GenericContainer, StartedTestContainer } from 'testcontainers';\n\njasmine.DEFAULT_TIMEOUT_INTERVAL = 60 * 1000 * 60;\n\n\ndescribe('jasmine demo with askui', () => {\n  let aui : AskuiClient;\n  let container: StartedTestContainer\n\n  beforeAll(async () => {\n    const browser = 'chrome';\n    const releaseVersion = 'v0.9.1';\n    const browserVersion = '99.0.4844.51';\n    const containerPath = `registry.gitlab.com/vqa4gui/mvp/askui/browser/${browser}:${releaseVersion}-${browserVersion}-amd64`;\n    \n    container = await new GenericContainer(containerPath)\n      .withEnv('ENABLE_VNC', 'true')\n      .withEnv('SCREEN_RESOLUTION', '1920x1080')\n      .withExposedPorts(6769, 5900)\n      .start();\n\n    console.log(`VNC link: ${container.getHost()}:${container.getMappedPort(5900)}`);\n    aui = new AskuiClient({\n      controlServerUrl: `http://${container.getHost()}:${container.getMappedPort(6769)}`,\n    });\n    await aui.connect();;\n  });\n\n  it('Should click on text', async () => {    \n    await aui.click().text().exec()\n  });\n\n  afterAll(async function clean() {\n    /**\n    * Closes the connection to the askui controlui-server\n    */\n    aui.close();\n\n    /**\n    * Stops the container\n    */\n    await container.stop();\n  });\n});\n")),(0,o.kt)("h2",{id:"connect-via-vnc"},"Connect via VNC"),(0,o.kt)("p",null,"To check what is happening inside a running test container, you can connect via VNC. For this, you need a VNC client like ",(0,o.kt)("a",{parentName:"p",href:"https://remmina.org/"},"Remmina"),". When running the example code from the previous chapter, the container's VNC port will be logged to the console. Use this port to connect. When connecting, enter the password ",(0,o.kt)("inlineCode",{parentName:"p"},"askui")," when asked."),(0,o.kt)("p",null,"Example of a VNC connection with a Chrome browser running inside a container:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"VNC Example",src:n(430).Z,width:"2562",height:"1415"})))}k.isMDXComponent=!0},430:function(e,t,n){t.Z=n.p+"assets/images/vnc-example-9077144d46d3f03f74248609d25a18a5.png"}}]);